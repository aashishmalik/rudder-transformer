[
  {
    "description": "Unsupported event type",
    "input": {
      "message": {
        "userId": "user123",
        "type": "abc",
        "properties": {
          "listData": {
            "add": [
              {
                "email": "alex@email.com"
              },
              {
                "email": "ryan@email.com"
              },
              {
                "email": "van@email.com"
              }
            ]
          }
        },
        "context": {
          "ip": "14.5.67.21",
          "library": {
            "name": "http"
          }
        },
        "timestamp": "2020-02-02T00:23:09.544Z"
      },
      "destination": {
        "Config": {
          "audienceId": "test-audienceId",
          "audienceName": "test-audienceName",
          "accessToken": "test-accessToken",
          "clientSideId": "test-clientSideId",
          "audienceUrl": "http://abc.com",
          "identifier": "email"
        }
      }
    },
    "output": {
      "error": "Event type abc is not supported. Aborting message."
    }
  },
  {
    "description": "List data is not passed",
    "input": {
      "message": {
        "userId": "user123",
        "type": "audiencelist",
        "properties": {},
        "context": {
          "ip": "14.5.67.21",
          "library": {
            "name": "http"
          }
        },
        "timestamp": "2020-02-02T00:23:09.544Z"
      },
      "destination": {
        "Config": {
          "audienceId": "test-audienceId",
          "audienceName": "test-audienceName",
          "accessToken": "test-accessToken",
          "clientSideId": "test-clientSideId",
          "audienceUrl": "http://abc.com",
          "identifier": "email"
        }
      }
    },
    "output": {
      "error": "`listData` is not present inside properties. Aborting message."
    }
  },
  {
    "description": "List data is empty",
    "input": {
      "message": {
        "userId": "user123",
        "type": "audiencelist",
        "properties": {
          "listData": {}
        },
        "context": {
          "ip": "14.5.67.21",
          "library": {
            "name": "http"
          }
        },
        "timestamp": "2020-02-02T00:23:09.544Z"
      },
      "destination": {
        "Config": {
          "audienceId": "test-audienceId",
          "audienceName": "test-audienceName",
          "accessToken": "test-accessToken",
          "clientSideId": "test-clientSideId",
          "audienceUrl": "http://abc.com",
          "identifier": "email"
        }
      }
    },
    "output": {
      "error": "`listData` is empty. Aborting message."
    }
  },
  {
    "description": "Unsupported action type",
    "input": {
      "message": {
        "userId": "user123",
        "type": "audiencelist",
        "properties": {
          "listData": {
            "update": [
              {
                "email": "alex@email.com"
              }
            ]
          }
        },
        "context": {
          "ip": "14.5.67.21",
          "library": {
            "name": "http"
          }
        },
        "timestamp": "2020-02-02T00:23:09.544Z"
      },
      "destination": {
        "Config": {
          "audienceId": "test-audienceId",
          "audienceName": "test-audienceName",
          "accessToken": "test-accessToken",
          "clientSideId": "test-clientSideId",
          "audienceUrl": "http://abc.com",
          "identifier": "email"
        }
      }
    },
    "output": {
      "error": "Unsupported action type. Aborting message."
    }
  },
  {
    "description": "Add members to the audience list",
    "input": {
      "message": {
        "userId": "user123",
        "type": "audiencelist",
        "properties": {
          "listData": {
            "add": [
              {
                "email": "alex@email.com"
              },
              {
                "email": "ryan@email.com"
              },
              {
                "email": "van@email.com"
              }
            ]
          }
        },
        "context": {
          "ip": "14.5.67.21",
          "library": {
            "name": "http"
          }
        },
        "timestamp": "2020-02-02T00:23:09.544Z"
      },
      "destination": {
        "Config": {
          "audienceId": "test-audienceId",
          "audienceName": "test-audienceName",
          "accessToken": "test-accessToken",
          "clientSideId": "test-clientSideId",
          "audienceUrl": "http://abc.com",
          "identifier": "email"
        }
      }
    },
    "output": {
      "version": "1",
      "type": "REST",
      "method": "POST",
      "endpoint": "https://app.launchdarkly.com/api/v2/segment-target/rudderstack",
      "headers": {
        "Authorization": "test-accessToken",
        "Content-Type": "application/json"
      },
      "params": {},
      "body": {
        "JSON": {
          "environmentId": "test-clientSideId",
          "cohortId": "test-audienceId",
          "cohortName": "test-audienceName",
          "cohortUrl": "http://abc.com",
          "listData": {
            "add": [
              {
                "id": "alex@email.com"
              },
              {
                "id": "ryan@email.com"
              },
              {
                "id": "van@email.com"
              }
            ],
            "remove": []
          }
        },
        "JSON_ARRAY": {},
        "XML": {},
        "FORM": {}
      },
      "files": {}
    }
  },
  {
    "description": "Remove members from the audience list",
    "input": {
      "message": {
        "userId": "user123",
        "type": "audiencelist",
        "properties": {
          "listData": {
            "remove": [
              {
                "email": "alex@email.com"
              },
              {
                "email": "ryan@email.com"
              },
              {
                "email": "van@email.com"
              }
            ]
          }
        },
        "context": {
          "ip": "14.5.67.21",
          "library": {
            "name": "http"
          }
        },
        "timestamp": "2020-02-02T00:23:09.544Z"
      },
      "destination": {
        "Config": {
          "audienceId": "test-audienceId",
          "audienceName": "test-audienceName",
          "accessToken": "test-accessToken",
          "clientSideId": "test-clientSideId",
          "audienceUrl": "http://abc.com",
          "identifier": "email"
        }
      }
    },
    "output": {
      "version": "1",
      "type": "REST",
      "method": "POST",
      "endpoint": "https://app.launchdarkly.com/api/v2/segment-target/rudderstack",
      "headers": {
        "Authorization": "test-accessToken",
        "Content-Type": "application/json"
      },
      "params": {},
      "body": {
        "JSON": {
          "environmentId": "test-clientSideId",
          "cohortId": "test-audienceId",
          "cohortName": "test-audienceName",
          "cohortUrl": "http://abc.com",
          "listData": {
            "remove": [
              {
                "id": "alex@email.com"
              },
              {
                "id": "ryan@email.com"
              },
              {
                "id": "van@email.com"
              }
            ],
            "add": []
          }
        },
        "JSON_ARRAY": {},
        "XML": {},
        "FORM": {}
      },
      "files": {}
    }
  },
  {
    "description": "Add/Remove members",
    "input": {
      "message": {
        "userId": "user123",
        "type": "audiencelist",
        "properties": {
          "listData": {
            "add": [
              {
                "email": "alex@email.com"
              },
              {
                "userId": "user1"
              }
            ],
            "remove": [
              {
                "email": "ryan@email.com"
              },
              {
                "userId": "user2"
              }
            ]
          }
        },
        "context": {
          "ip": "14.5.67.21",
          "library": {
            "name": "http"
          }
        },
        "timestamp": "2020-02-02T00:23:09.544Z"
      },
      "destination": {
        "Config": {
          "audienceId": "test-audienceId",
          "audienceName": "test-audienceName",
          "accessToken": "test-accessToken",
          "clientSideId": "test-clientSideId",
          "audienceUrl": "http://abc.com",
          "identifier": "email"
        }
      }
    },
    "output": {
      "version": "1",
      "type": "REST",
      "method": "POST",
      "endpoint": "https://app.launchdarkly.com/api/v2/segment-target/rudderstack",
      "headers": {
        "Authorization": "test-accessToken",
        "Content-Type": "application/json"
      },
      "params": {},
      "body": {
        "JSON": {
          "environmentId": "test-clientSideId",
          "cohortId": "test-audienceId",
          "cohortName": "test-audienceName",
          "cohortUrl": "http://abc.com",
          "listData": {
            "add": [
              {
                "id": "alex@email.com"
              }
            ],
            "remove": [
              {
                "id": "ryan@email.com"
              }
            ]
          }
        },
        "JSON_ARRAY": {},
        "XML": {},
        "FORM": {}
      },
      "files": {}
    }
  },
  {
    "description": "Phone number as identifier",
    "input": {
      "message": {
        "userId": "user123",
        "type": "audiencelist",
        "properties": {
          "listData": {
            "add": [
              {
                "email": "alex@email.com"
              },
              {
                "email": "ryan@email.com",
                "phone": "9999999991"
              },
              {
                "email": "van@email.com",
                "phone": "9999999992"
              }
            ]
          }
        },
        "context": {
          "ip": "14.5.67.21",
          "library": {
            "name": "http"
          }
        },
        "timestamp": "2020-02-02T00:23:09.544Z"
      },
      "destination": {
        "Config": {
          "audienceId": "test-audienceId",
          "audienceName": "test-audienceName",
          "accessToken": "test-accessToken",
          "clientSideId": "test-clientSideId",
          "audienceUrl": "http://abc.com",
          "identifier": "phone"
        }
      }
    },
    "output": {
      "version": "1",
      "type": "REST",
      "method": "POST",
      "endpoint": "https://app.launchdarkly.com/api/v2/segment-target/rudderstack",
      "headers": {
        "Authorization": "test-accessToken",
        "Content-Type": "application/json"
      },
      "params": {},
      "body": {
        "JSON": {
          "environmentId": "test-clientSideId",
          "cohortId": "test-audienceId",
          "cohortName": "test-audienceName",
          "cohortUrl": "http://abc.com",
          "listData": {
            "add": [
              {
                "id": "9999999991"
              },
              {
                "id": "9999999992"
              }
            ],
            "remove": []
          }
        },
        "JSON_ARRAY": {},
        "XML": {},
        "FORM": {}
      },
      "files": {}
    }
  }
]
